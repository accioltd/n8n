{"createdAt":"2025-06-04T02:04:55.414Z","updatedAt":"2025-06-17T15:02:18.453Z","id":"CCpLwZvgd1lH4vjw","name":"Craw4AI","active":false,"nodes":[{"parameters":{},"id":"77abfe8c-7a08-4b9b-a553-58619587f909","name":"When clicking ‘Test workflow’","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[100,840]},{"parameters":{"url":"https://ai.pydantic.dev/sitemap.xml","options":{}},"id":"d3aecaa0-4652-415d-a096-8f92f43a1350","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[300,700]},{"parameters":{"options":{}},"id":"39b70873-f6a3-4933-baee-d297e7ed3cd3","name":"XML","type":"n8n-nodes-base.xml","typeVersion":1,"position":[500,900]},{"parameters":{"fieldToSplitOut":"urlset.url","options":{}},"id":"ae97a0ba-c94a-4d45-b69f-42f6c93b1eca","name":"Split Out","type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[660,700]},{"parameters":{"options":{}},"id":"d18f14e7-5d3c-492c-a236-825b743c14ec","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[900,800]},{"parameters":{"jsonMode":"expressionData","jsonData":"={{ $json.results[0].markdown }}","options":{"metadata":{"metadataValues":[{"name":"page","value":"={{ $json.results[0].url }}"}]}}},"id":"097b2d2c-fa9e-433e-9a12-47034389d2d4","name":"Default Data Loader","type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1,"position":[1780,1840]},{"parameters":{"chunkSize":5000},"id":"8af68fd2-bc35-4593-acff-a357ab2b090a","name":"Character Text Splitter","type":"@n8n/n8n-nodes-langchain.textSplitterCharacterTextSplitter","typeVersion":1,"position":[1920,1980]},{"parameters":{"options":{}},"id":"6e700ca2-fa45-495a-89ac-97dd88528e7a","name":"When chat message received","type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[760,40],"webhookId":"0949763f-f3f7-46bf-8676-c050d92e6966"},{"parameters":{"options":{}},"id":"92693315-b3fa-4d76-8a0d-4c0fbc4e457d","name":"OpenAI Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[920,260],"credentials":{"openAiApi":{"id":"hXdJ6XcRQuQPFcMt","name":"OpenAi account"}}},{"parameters":{},"id":"d077ed5f-ffe1-4821-b1be-713ff0e28e7c","name":"Postgres Chat Memory","type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[1060,260],"credentials":{"postgres":{"id":"LtUvizUisCSKWSoT","name":"Postgres Supabase"}}},{"parameters":{"name":"pydantic_ai_docs","description":"Retrieves data related to Pydantic AI using their documentation."},"id":"487400d3-225c-498b-9f27-4132d57ff3bd","name":"Vector Store Tool","type":"@n8n/n8n-nodes-langchain.toolVectorStore","typeVersion":1,"position":[1400,160]},{"parameters":{"options":{}},"id":"fbb6dd7d-3806-4de7-9680-a085f6c99571","name":"Embeddings OpenAI1","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.1,"position":[1160,460],"credentials":{"openAiApi":{"id":"hXdJ6XcRQuQPFcMt","name":"OpenAi account"}}},{"parameters":{"options":{}},"id":"440258fc-3199-4747-9afb-6fd10288b3c5","name":"OpenAI Chat Model1","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[1540,340],"credentials":{"openAiApi":{"id":"hXdJ6XcRQuQPFcMt","name":"OpenAi account"}}},{"parameters":{"mode":"insert","tableName":{"__rl":true,"value":"documents_pg","mode":"list","cachedResultName":"documents_pg"},"options":{"queryName":"match_documents"}},"id":"a7f7da1d-ad92-4a90-adbe-caf98aac6dbd","name":"Supabase Vector Store","type":"@n8n/n8n-nodes-langchain.vectorStoreSupabase","typeVersion":1,"position":[1640,1620],"credentials":{"supabaseApi":{"id":"bRZ7y2Ib79S89Ydt","name":"Supabase account"}}},{"parameters":{"options":{}},"id":"8e9cceb1-2719-40a5-b34e-361e24b5ec27","name":"AI Agent","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[1020,40]},{"parameters":{"tableName":{"__rl":true,"value":"documents","mode":"list","cachedResultName":"documents"},"options":{"queryName":"match_documents"}},"id":"1f379513-4efe-472d-a56e-d045383ba5b1","name":"Supabase Vector Store1","type":"@n8n/n8n-nodes-langchain.vectorStoreSupabase","typeVersion":1,"position":[1200,320],"credentials":{"supabaseApi":{"id":"bRZ7y2Ib79S89Ydt","name":"Supabase account"}}},{"parameters":{"method":"POST","url":"http://crawl4ai:11235/crawl","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"urls\": [\"{{$json.loc}}\"],\n  \"browser_config\": {\n    \"type\": \"BrowserConfig\",\n    \"params\": { \"headless\": true }\n  },\n  \"crawler_config\": {\n    \"type\": \"CrawlerRunConfig\",\n    \"params\": { \"stream\": false, \"cache_mode\": \"bypass\" }\n  }\n}","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"6949ab21-f812-4acb-a5a1-304b38dd4c32","name":"Trigger Local Crawl4AI","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1100,920]},{"parameters":{"options":{}},"id":"52ed7b40-cfde-4e96-b6dc-126d7455b58d","name":"Embeddings OpenAI","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.1,"position":[1580,1820],"credentials":{"openAiApi":{"id":"hXdJ6XcRQuQPFcMt","name":"OpenAi account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE EXTENSION IF NOT EXISTS pgcrypto;\nCREATE EXTENSION IF NOT EXISTS vector;\n\nCREATE TABLE IF NOT EXISTS public.documents (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  content TEXT,\n  embedding VECTOR(1536),\n  metadata JSONB\n);\n\nCREATE INDEX IF NOT EXISTS idx_documents_embedding \n  ON public.documents USING ivfflat (embedding) WITH (lists = 100);\n","additionalFields":{}},"id":"7313cf23-9411-401f-97a6-c6bfd6abec11","name":"Init Documents Table","type":"n8n-nodes-base.postgres","typeVersion":1,"position":[240,1180],"credentials":{"postgres":{"id":"LtUvizUisCSKWSoT","name":"Postgres Supabase"}}},{"parameters":{"chunkSize":400,"options":{}},"type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","typeVersion":1,"position":[1620,1340],"id":"1b82ac36-cc5c-404a-926d-4f08c66a3511","name":"Recursive Character Text Splitter"},{"parameters":{"mode":"insert","tableName":"documents_pg","options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1,"position":[1420,920],"id":"3af2ecd1-adcd-47c6-aade-b3192d9a6aac","name":"Postgres PGVector Store RAG","credentials":{"postgres":{"id":"LtUvizUisCSKWSoT","name":"Postgres Supabase"}}},{"parameters":{"model":"nomic-embed-text:latest"},"type":"@n8n/n8n-nodes-langchain.embeddingsOllama","typeVersion":1,"position":[1400,1140],"id":"0b2c6b23-1e1f-4014-a2f2-09b63a978ca3","name":"Embeddings Ollama RAG","credentials":{"ollamaApi":{"id":"I1l9z6pk7m1DIC6U","name":"Ollama account"}}},{"parameters":{"jsonMode":"expressionData","jsonData":"={{ $json.data || $json.text || $json.concatenated_data || $json.results[0].markdown }}","options":{"metadata":{"metadataValues":[{"name":"=file_id","value":"={{ $('Set Metadata').first().json.file_id }}"},{"name":"file_name","value":"={{ $('Set Metadata').item.json.file_name }}"},{"name":"file_mimetype","value":"={{ $('Set Metadata').item.json.file_mimetype }}"},{"name":"file_size","value":"={{ $('Set Metadata').item.json.file_size }}"},{"name":"file_path","value":"={{ $('Set Metadata').item.json.file_path }}"},{"name":"company","value":"={{ $('Set Metadata').item.json.company }}"},{"name":"title","value":"={{ $('Set Metadata').item.json.title }}"},{"name":"file_ext","value":"={{ $('Set Metadata').item.json.file_ext }}"}]}}},"id":"2c36e8e9-d2ca-4723-a61e-91d02b58f80e","name":"Default Data Loader1","type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1,"position":[1520,1140]}],"connections":{"When clicking ‘Test workflow’":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"XML","type":"main","index":0}]]},"XML":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Trigger Local Crawl4AI","type":"main","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Supabase Vector Store","type":"ai_document","index":0}]]},"Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader","type":"ai_textSplitter","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Postgres Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Vector Store Tool":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Embeddings OpenAI1":{"ai_embedding":[[{"node":"Supabase Vector Store1","type":"ai_embedding","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"Vector Store Tool","type":"ai_languageModel","index":0}]]},"Supabase Vector Store":{"main":[[]]},"Supabase Vector Store1":{"ai_vectorStore":[[{"node":"Vector Store Tool","type":"ai_vectorStore","index":0}]]},"Trigger Local Crawl4AI":{"main":[[{"node":"Postgres PGVector Store RAG","type":"main","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Supabase Vector Store","type":"ai_embedding","index":0}]]},"Recursive Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader1","type":"ai_textSplitter","index":0}]]},"Embeddings Ollama RAG":{"ai_embedding":[[{"node":"Postgres PGVector Store RAG","type":"ai_embedding","index":0}]]},"Default Data Loader1":{"ai_document":[[{"node":"Postgres PGVector Store RAG","type":"ai_document","index":0}]]},"Postgres PGVector Store RAG":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"01b67e38-8386-48f3-aa42-267c95009240","triggerCount":0,"tags":[]}